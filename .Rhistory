setkey(dt, unit)
if(verbose){message("Starting to loop over units...")}
if(cores == 1) {
XeeXhs <- lapply(panelUnique, function(t) iterateObs(sub_index = t,
type = "serial", cutoff = lag_cutoff))
} else {
XeeXhs <- mclapply(panelUnique,function(t) iterateObs(sub_index = t,
type = "serial", cutoff = lag_cutoff), mc.cores = cores)
}
XeeX_serial <- Reduce("+",  XeeXhs)
XeeX <- XeeX + XeeX_serial
V_spatial_HAC <- invXX %*% (XeeX / n) %*% invXX / n
V_spatial_HAC <- (V_spatial_HAC + t(V_spatial_HAC)) / 2
return_list <- list(
"OLS" = reg$vcv,
"Spatial" = V_spatial,
"Spatial_HAC" = V_spatial_HAC)
return(return_list)
}
tab4.dat <- read.dta('01_Data/REPLICATION_APSR_2014_BRQ/REPLICATION_TABLE_4_APSR_2014_BRQ.dta')
####REPLICATE TABLE 4####
#read in data for table 4
tab4.dat <- read.dta('01_Data/REPLICATION_APSR_2014_BRQ/REPLICATION_TABLE_4_APSR_2014_BRQ.dta')
#function for clustered SEs
cluster.se<-function(model, cluster){
vcovCL<-cluster.vcov(model, cluster)
coef<-coeftest(model, vcovCL)
return(coef)
}
tab4.1<- lm(inter_group_trust ~ age+age2+male+urban_dum+WarPrevalence14001700+ln_export_pop+ln_pop_dens_1400+
lrgdpl2631960+abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+low_tempNUNN+
ln_coastline_areaNUNN+islam+
ln_avg_gold_pop+ln_avg_oil_pop+ln_avg_all_diamonds_pop+
f_pothco+
rugged+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data = tab4.dat)
tab4.1.cluster <- cluster.se(tab4.1, tab4.dat$townvill)
tab4.1$vcovHC <- vcovHC(tab4.1,type='HC1')
tab4.1$errors <- sqrt(diag(tab4.1$vcovHC))
tab4.2 <- lm(identitydumeth ~ age+age2+male+urban_dum+WarPrevalence14001700+ln_export_pop+ln_pop_dens_1400+
lrgdpl2631960+abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+low_tempNUNN+
ln_coastline_areaNUNN+islam+ln_avg_gold_pop+ln_avg_oil_pop+ln_avg_all_diamonds_pop+
f_pothco+
rugged+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data = tab4.dat)
tab4.2.cluster <- cluster.se(tab4.2, tab4.dat$townvill)
tab4.2$vcovHC <- vcovHC(tab4.2,type='HC1')
tab4.2$errors <- sqrt(diag(tab4.2$vcovHC))
tab2.conley <- ConleySEs(reg = tab4.2,
unit = NULL,
time = NULL,
lat = "abs_latitudeNUNN", lon = "longitudeNUNN",
dist_fn = "SH", dist_cutoff = 500,
lag_cutoff = 5,
cores = 1,
verbose = FALSE)
library(lfe)
?lfe
setwd('~/Google Drive/GOV_2001_REPLICATION/01_Data/REPLICATION_APSR_2014_BRQ/')
####  GOV 2001: REPLICATION PAPER   ####
##PAPER: BESLEY AND REYNAL-QUEROL (2014, APSR)
##AUTHORS: JEREMY BOWLES, JESSIE BULLOCK, SHOM MAZUMDER
##FIRST CREATED: 03/10/2016
##LAST UPDATED: 03/16/2016
##PURPOSE: THIS SCRIPT REPLICATES ALL OF THE TABLES/ANALYSES IN BESLEY AND REYNAL-QUEROL (2014)
##NOTES:
####Load Packages####
library(foreign)
library(ggplot2)
library(plyr)
library(stargazer)
library(sandwich)
library(multiwayvcov)
library(MASS)
library(rms)
library(lmtest)
library(ordinal)
library(aod)
tab2_3.dat <- read.dta('REPLICATION_TABLE_2_3_APSR_2014_BRQ.dta')
tab2_3.dat$everWar <- ifelse(tab2_3.dat$WarPrevalence14001700==0,0,1)
summary(tab2_3.dat$everWar)
#ESTIMATE PROPENSITY SCORE FOR EXTENSIVE MARGIN
pscore.model <- glm(everWar ~ lrgdpl2631970 + region_nNUNN + region_sNUNN + region_wNUNN + region_eNUNN +
region_cNUNN + f_french + f_spain + f_pothco + f_dutch + f_belg + f_italy + f_germ +
abs_latitudeNUNN + longitudeNUNN + rain_minNUNN  + humid_maxNUNN +  low_tempNUNN + ln_coastline_areaNUNN +
island_dumNUNN + islam + legor_frNUNN + ln_avg_gold_pop + ln_avg_oil_pop + ln_avg_all_diamonds_pop +
ETHPOL + yellow + rugged,
data=tab2_3.dat,
family=binomial(link='logit'))
tab2_3.dat$pscores <- predict(pscore.model,type='response')
pscore.model <- glm(everWar ~ f_french + f_spain + f_pothco + f_dutch + f_belg + f_italy + f_germ +
region_nNUNN + region_sNUNN + region_wNUNN + region_eNUNN + region_cNUNN,
data=tab2_3.dat,
family=binomial(link='logit'))
tab2_3.dat$pscores <- predict(pscore.model,type='response')
summary(pscore.model)
pscore.model <- glm(everWar ~ f_french + f_pothco + f_belg + f_italy + f_germ +
region_nNUNN + region_sNUNN + region_wNUNN + region_eNUNN,
data=tab2_3.dat,
family=binomial(link='logit'))
tab2_3.dat$pscores <- predict(pscore.model,type='response')
predict(pscore.model,type='response')
nrow(tab2_3.dat)
tab2_3.dat$pscores <- predict(pscore.model,type='response')
####DIAGNOSTICS####
##Date: 04/03/2012
#set working directory
setwd('~/Google Drive/GOV_2001_REPLICATION/01_Data/REPLICATION_APSR_2014_BRQ/')
#load data for tables 2 and 3
tab2_3.dat <- read.dta('REPLICATION_TABLE_2_3_APSR_2014_BRQ.dta')
#create indicator variable if ever had historic conflict
tab2_3.dat$everWar <- ifelse(tab2_3.dat$WarPrevalence14001700==0,0,1)
summary(tab2_3.dat$everWar)
length(tab2_3.dat$everWar)
pscore.model <- glm(everWar ~ f_french + f_pothco + f_belg + f_italy + f_germ +
region_nNUNN + region_sNUNN + region_wNUNN + region_eNUNN,
data=tab2_3.dat,
family=binomial(link='logit'))
tab2_3.dat$pscores <- predict(pscore.model,type='response')
predict(pscore.model,type='response')
length(predict(pscore.model,type='response'))
length(tab2_3.dat$f_french)
length(tab2_3.dat$region_nNUNN)
length(tab2_3.dat$region_sNUNN)
length(tab2_3.dat$region_wNUNN)
length(tab2_3.dat$region_eNUNN)
length(tab2_3.dat$f_pothco)
length(tab2_3.dat$f_belg)
length(tab2_3.dat$f_italy)
length(tab2_3.dat$f_germ)
predict(pscore.model)
predict(pscore.model,type='response')
length(tab2_3.dat$everWar)
pscore.model <- glm(everWar ~ f_french + f_pothco + f_belg + f_italy + f_germ +
region_nNUNN + region_sNUNN + region_wNUNN + region_eNUNN,
data=tab2_3.dat,
family=binomial(link='logit'))
tab2_3.dat$pscores <- predict(pscore.model,type='response')
tab2_3.dat$pscores
View(tab2_3.dat)
pscores <- c(pscores[1:16],NA,pscores[17:49])
pscores <- predict(pscore.model,type='response')
pscores <- c(pscores[1:16],NA,pscores[17:49])
pscores
tab2_3.dat$pscores <- pscores
pscore.model <- glm(everWar ~ f_french + f_pothco + f_belg + f_italy + f_germ +
region_nNUNN + region_sNUNN + region_wNUNN + region_eNUNN,
data=tab2_3.dat,
family=binomial(link='logit'))
pscores <- predict(pscore.model,type='response')
pscores <- c(pscores[1:16],NA,pscores[17:48])
tab2_3.dat$pscores <- pscores
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
library(ggplot2)
pscore.plot <- ggplot(data=tab2_3.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching)')
pscore.plot
ks.test(tab2_3.dat$pscores[tab2_3.dat$everWar==1],tab2_3.dat$pscores[tab2_3.dat$everWar==0])
tab4.dat <- read.dta('REPLICATION_TABLE_4_APSR_2014_BRQ.dta')
tab4.dat$everWar <- ifelse(tab4.dat$WarPrevalence14001700==0,0,1)
summary(tab4.dat$everWar)
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+WarPrevalence14001700+ln_export_pop+ln_pop_dens_1400+
lrgdpl2631960+abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+low_tempNUNN+
ln_coastline_areaNUNN+islam+
ln_avg_gold_pop+ln_avg_oil_pop+ln_avg_all_diamonds_pop+
f_pothco+
rugged+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab2_3.dat,
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+WarPrevalence14001700+ln_export_pop+ln_pop_dens_1400+
lrgdpl2631960+abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+low_tempNUNN+
ln_coastline_areaNUNN+islam+
ln_avg_gold_pop+ln_avg_oil_pop+ln_avg_all_diamonds_pop+
f_pothco+
rugged+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'))
summary(pscore.model.subnat)
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
lrgdpl2631960+abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+low_tempNUNN+
ln_coastline_areaNUNN+islam+
ln_avg_gold_pop+ln_avg_oil_pop+ln_avg_all_diamonds_pop+
f_pothco+
rugged+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'))
summary(pscore.model.subnat)
tab4.1<- lm(inter_group_trust ~ age+age2+male+urban_dum+WarPrevalence14001700+ln_export_pop+ln_pop_dens_1400+
lrgdpl2631960+abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+low_tempNUNN+
ln_coastline_areaNUNN+islam+
ln_avg_gold_pop+ln_avg_oil_pop+ln_avg_all_diamonds_pop+
f_pothco+
rugged+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data = tab4.dat)
summary(tab4.1)
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
lrgdpl2631960+abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+low_tempNUNN+
ln_coastline_areaNUNN+islam+
ln_avg_gold_pop+ln_avg_oil_pop+ln_avg_all_diamonds_pop+
f_pothco+
rugged,
data=tab4.dat,
family=binomial(link='logit'))
summary(pscore.model.subnat)
summary(tab4.dat$everWar)
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
lrgdpl2631960+abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+low_tempNUNN+
ln_coastline_areaNUNN+islam+
ln_avg_gold_pop+ln_avg_oil_pop+ln_avg_all_diamonds_pop+
f_pothco+
rugged+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'))
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
lrgdpl2631960+abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+low_tempNUNN+
ln_coastline_areaNUNN+islam+
f_pothco+
rugged+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'))
pscore.model.subnat <- glm(everWar ~ age+age2+male+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'))
summary(pscore.model.subnat)
pscores.subnat <- predict(pscore.model,type='response')
#pscores.subnat <- c(pscores[1:16],NA,pscores[17:48])#correct for missing data in Eritrea
tab4.dat$pscores <- pscores.subnat
pscore.model.subnat <- glm(everWar ~ age+age2+male+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'))
pscores.subnat <- predict(pscore.model.subnat,type='response')
#pscores.subnat <- c(pscores[1:16],NA,pscores[17:48])#correct for missing data in Eritrea
tab4.dat$pscores <- pscores.subnat
na.omit(tab4.dat)
tab4.dat$pscores <- pscores.subnat
?predict
pscore.model.subnat <- glm(everWar ~ age+age2+male+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'))
pscores.subnat <- predict(pscore.model.subnat,type='response',na.action=na.exclude)
tab4.dat$pscores <- pscores.subnat
pscores.subnat <- predict(pscore.model.subnat,type='response',na.action=na.exclude)
pscores.subnat
pscores.subnat <- predict(pscore.model.subnat,type='response',na.exclude)
pscores.subnat <- predict(pscore.model.subnat,type='response',na.action(na.exclude))
tab4.dat$pscores <- pscores.subnat
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
?glm
pscore.model.subnat <- glm(everWar ~ age+age2+male+factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
library(ggplot2)
pscore.plot.subnat <- ggplot(data=tab4.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Sub-National)')
pscore.plot.subnat
pscore.model.crossnat <- glm(everWar ~ f_french + f_pothco + f_belg + f_italy + f_germ +
region_nNUNN + region_sNUNN + region_wNUNN + region_eNUNN,
data=tab2_3.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.crossnat <- predict.glm(pscore.model.crossnat,type='response',na.action = na.exclude)
#pscores.crossnat <- c(pscores[1:16],NA,pscores[17:48])#correct for missing data in Eritrea
tab2_3.dat$pscores <- pscores.crossnat
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
library(ggplot2)
pscore.plot.crossnat <- ggplot(data=tab2_3.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Cross-National)')
pscore.plot.crossnat
tab567.dat <- read.dta('REPLICATION_TABLE_5_6_7_APSR_2014_BRQ.dta')
tab567.dat$everWar <- ifelse(tab567.dat$HistoricalConflictGrid==0,0,1)
summary(tab567.dat$HistoricalConflictGrid)
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
pscore.plot.subnat <- ggplot(data=tab4.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Sub-National)')
pscore.plot.subnat
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
pscore.plot.subnat <- ggplot(data=tab4.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Sub-National)')
pscore.plot.subnat
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
pscore.plot.subnat <- ggplot(data=tab4.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Sub-National)')
pscore.plot.subnat
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
abs_latitudeNUNN+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
pscore.plot.subnat <- ggplot(data=tab4.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Sub-National)')
pscore.plot.subnat
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
abs_latitudeNUNN+longitudeNUNN+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
pscore.plot.subnat <- ggplot(data=tab4.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Sub-National)')
pscore.plot.subnat
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
pscore.plot.subnat <- ggplot(data=tab4.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Sub-National)')
pscore.plot.subnat
hist(pscores.subnat)
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
pscore.plot.subnat <- ggplot(data=tab4.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Sub-National)')
pscore.plot.subnat
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+
low_tempNUNN+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+ln_coastline_areaNUNN+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
abs_latitudeNUNN+longitudeNUNN+rain_minNUNN+humid_maxNUNN+islam+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
pscore.plot.subnat <- ggplot(data=tab4.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Sub-National)')
pscore.plot.subnat
ks.test(tab4.dat$pscores[tab4.dat$everWar==1],tab4.dat$pscores[tab4.dat$everWar==0])
pscore.model.grid <- glm(HistoricalConflictGrid ~ d1 + elev_srtm_pred + rough + tempav_8008 +
precsdnew_80_08 + area + lpopdens90 + gridcity1400 + zulu_king + merina + monomotapa +
lozi + malawi + kilwa + lunda + congo + luba + rwanda + buganda + ashanti + yoruba +
ethiopia + axum + wolof + ghana + mali + kush + songhay + kanem_born + clas_egypt +
carthage + factor(country),
data=tab567.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.grid <- predict.glm(pscore.model.grid,type='response',na.action = na.exclude)
tab567.dat$pscores <- pscores.grid
pscore.plot.grid <- ggplot(data=tab567.dat,aes(x=pscores,group=factor(HistoricalConflictGrid),colour=factor(HistoricalConflictGrid)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Historical Conflict in Grid'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Grid-Level)')
pscore.plot.grid
ks.test(tab567.dat$pscores[tab567.dat$HistoricalConflictGrid==1],
tab567.dat$pscores[tab567.dat$HistoricalConflictGrid==0])
####DIAGNOSTICS####
##Date: 04/03/2012
####SET UP####
#set working directory
setwd('~/Google Drive/GOV_2001_REPLICATION/01_Data/REPLICATION_APSR_2014_BRQ/')
#load data for tables 2 and 3
tab2_3.dat <- read.dta('REPLICATION_TABLE_2_3_APSR_2014_BRQ.dta')
#load data for sub-national afrobarometer analysis
tab4.dat <- read.dta('REPLICATION_TABLE_4_APSR_2014_BRQ.dta')
#load in grid-level data
tab567.dat <- read.dta('REPLICATION_TABLE_5_6_7_APSR_2014_BRQ.dta')
#create indicator variables if ever had historic conflict
tab2_3.dat$everWar <- ifelse(tab2_3.dat$WarPrevalence14001700==0,0,1)
tab4.dat$everWar <- ifelse(tab4.dat$WarPrevalence14001700==0,0,1)
####CHECK FOR COMMON SUPPORT (CROSS-NATIONAL)####
#ESTIMATE PROPENSITY SCORE FOR EXTENSIVE MARGIN
pscore.model.crossnat <- glm(everWar ~ f_french + f_pothco + f_belg + f_italy + f_germ +
region_nNUNN + region_sNUNN + region_wNUNN + region_eNUNN,
data=tab2_3.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.crossnat <- predict.glm(pscore.model.crossnat,type='response',na.action = na.exclude)
library(foreign)
library(foreign)
####SET UP####
#set working directory
setwd('~/Google Drive/GOV_2001_REPLICATION/01_Data/REPLICATION_APSR_2014_BRQ/')
#load data for tables 2 and 3
tab2_3.dat <- read.dta('REPLICATION_TABLE_2_3_APSR_2014_BRQ.dta')
#load data for sub-national afrobarometer analysis
tab4.dat <- read.dta('REPLICATION_TABLE_4_APSR_2014_BRQ.dta')
#load in grid-level data
tab567.dat <- read.dta('REPLICATION_TABLE_5_6_7_APSR_2014_BRQ.dta')
#create indicator variables if ever had historic conflict
tab2_3.dat$everWar <- ifelse(tab2_3.dat$WarPrevalence14001700==0,0,1)
tab4.dat$everWar <- ifelse(tab4.dat$WarPrevalence14001700==0,0,1)
####CHECK FOR COMMON SUPPORT (CROSS-NATIONAL)####
#ESTIMATE PROPENSITY SCORE FOR EXTENSIVE MARGIN
pscore.model.crossnat <- glm(everWar ~ f_french + f_pothco + f_belg + f_italy + f_germ +
region_nNUNN + region_sNUNN + region_wNUNN + region_eNUNN,
data=tab2_3.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.crossnat <- predict.glm(pscore.model.crossnat,type='response',na.action = na.exclude)
#pscores.crossnat <- c(pscores[1:16],NA,pscores[17:48])#correct for missing data in Eritrea
tab2_3.dat$pscores <- pscores.crossnat
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
library(ggplot2)
pscore.plot.crossnat <- ggplot(data=tab2_3.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Cross-National)')
pscore.plot.crossnat
ks.test(tab2_3.dat$pscores[tab2_3.dat$everWar==1],tab2_3.dat$pscores[tab2_3.dat$everWar==0])
#ESTIMATE PROPENSITY SCORE FOR EXTENSIVE MARGIN
pscore.model.subnat <- glm(everWar ~ age+age2+male+urban_dum+ln_export_pop+ln_pop_dens_1400+
factor(education)+factor(occupation)+factor(religion)+factor(living_conditions),
data=tab4.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.subnat <- predict.glm(pscore.model.subnat,type='response',na.action = na.exclude)
tab4.dat$pscores <- pscores.subnat
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
pscore.plot.subnat <- ggplot(data=tab4.dat,aes(x=pscores,group=factor(everWar),colour=factor(everWar)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Ever Historical War'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Sub-National)')
pscore.plot.subnat
#ESTIMATE PROPENSITY SCORE FOR EXTENSIVE MARGIN
pscore.model.grid <- glm(HistoricalConflictGrid ~ d1 + elev_srtm_pred + rough + tempav_8008 +
precsdnew_80_08 + area + lpopdens90 + gridcity1400 + zulu_king + merina + monomotapa +
lozi + malawi + kilwa + lunda + congo + luba + rwanda + buganda + ashanti + yoruba +
ethiopia + axum + wolof + ghana + mali + kush + songhay + kanem_born + clas_egypt +
carthage + factor(country),
data=tab567.dat,
family=binomial(link='logit'),
na.action = na.exclude)
pscores.grid <- predict.glm(pscore.model.grid,type='response',na.action = na.exclude)
tab567.dat$pscores <- pscores.grid
#PLOT DENSITY OF PROPENSITY SCORES BY TREATMENT
pscore.plot.grid <- ggplot(data=tab567.dat,aes(x=pscores,group=factor(HistoricalConflictGrid),colour=factor(HistoricalConflictGrid)))+
geom_density(size=1.5)+
scale_color_discrete(guide = guide_legend(title='Historical Conflict in Grid'))+xlab('Propensity Scores')+
ggtitle('Distribution of Propensity Scores (Before Matching, Grid-Level)')
pscore.plot.grid
